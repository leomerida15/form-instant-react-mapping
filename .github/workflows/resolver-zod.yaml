name: Deploy @form-instant/react-resolver-zod

on:
    push:
        branches: [resolver-zod/main]

jobs:
    deploy:
        name: Lint, test, build & publish

        runs-on: ubuntu-latest

        steps:
            - name: â‡ï¸ Checkout repo
              uses: actions/checkout@v4

            - name: Set up Bun
              uses: oven-sh/setup-bun@v1
              with:
                  bun-version: latest

            - name: ğŸ“¥ Install dependencies with Bun (with cache)
              run: bun install

            - name: ğŸ’… Lint react-resolver-zod
              run: bun run --filter '@form-instant/react-resolver-zod' lint

            - name: ğŸ” Type-check react-resolver-zod
              run: bun run --filter '@form-instant/react-resolver-zod' type:check

            - name: ğŸ› ï¸ Build react-resolver-zod
              run: bun run --filter '@form-instant/react-resolver-zod' build

            - name: ğŸš€ Publish @form-instant/react-resolver-zod to npm
              uses: JS-DevTools/npm-publish@v1
              with:
                  token: ${{ secrets.NPM_TOKEN }}
                  package: packages/react-resolver-zod/package.json
                  access: public
